<!DOCTYPE html>
<html>
<head>
  <title>Manager Dashboard</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body { margin:0; font-family: Arial; background:#1e1e1e; color:#fff; }
    .sidebar { position: fixed; left:0; top:0; width:220px; height:100%; background:#2a2a2a; flex-direction: column; display:flex; padding-top:20px; }
    .sidebar a { color:#fff; padding:15px 20px; text-decoration:none; display:block; transition:0.3s; }
    .sidebar a:hover { background:#00adb5; color:#fff; }
    .navbar { margin-left:220px; height:60px; background:#2a2a2a; display:flex; align-items:center; justify-content:space-between; padding:0 20px; border-bottom:1px solid #333; }
    .navbar h2 { margin:0; }
    .main { margin-left:220px; padding:20px; }
    .cards { display:flex; gap:20px; margin-bottom:20px; }
    .card { flex:1; background:#2a2a2a; padding:20px; border-radius:10px; box-shadow:0 4px 10px rgba(0,0,0,0.6); text-align:center; }
    .card h3 { margin:0 0 10px 0; color:#00adb5; }
    table { width:100%; border-collapse: collapse; background:#2a2a2a; border-radius:10px; overflow:hidden; box-shadow:0 4px 10px rgba(0,0,0,0.6); }
    th, td { padding:12px; border-bottom:1px solid #3a3a3a; text-align:left; }
    th { background:#00adb5; color:white; }
    tr:hover { background:#333; }
    button { padding:6px 12px; border:none; border-radius:5px; cursor:pointer; color:white; }
    .btn-add { background:#00adb5; }
    .btn-add:hover { background:#019ca5; }
    .btn-delete { background:crimson; }
    .btn-delete:hover { background:darkred; }
    .btn-edit { background:orange; }
    .btn-edit:hover { background:darkorange; }
    .modal { display:none; position:fixed; z-index:100; left:0; top:0; width:100%; height:100%; overflow:auto; background:rgba(0,0,0,0.7); }
    .modal-content { background:#2a2a2a; margin:10% auto; padding:20px; border-radius:10px; width:400px; position:relative; }
    .close { position:absolute; right:15px; top:10px; font-size:25px; cursor:pointer; color:#fff; }
    input, select { width:100%; padding:10px; margin:8px 0; border:none; border-radius:5px; background:#3a3a3a; color:#fff; }
  </style>
</head>
<body>

 <div class="sidebar">
  <a href="#" id="openModal"><i class="fa fa-user-plus"></i> Add Employee</a>
  <a href="/employees"><i class="fa fa-users"></i> View Employees</a>
  <a href="/reports"><i class="fa fa-file-alt"></i> Reports</a>
  <a href="/logout"><i class="fa fa-sign-out-alt"></i> Logout</a>
</div>



  <div class="navbar">
  <h2>Bank Manager Dashboard</h2>
  <div class="profile"><i class="fa fa-user-circle"></i> <span><%= managerName %></span></div>
</div>


  <div class="main">
    <div class="cards">
      <div class="card"><h3>Total Employees</h3><p><%= employees.length %></p></div>
      <div class="card"><h3>Total Salary</h3><p>₹<%= employees.reduce((a,b) => a + parseFloat(b.salary), 0) %></p></div>
      <div class="card"><h3>Managers</h3><p><%= employees.filter(e => e.role==='Manager').length %></p></div>
      <div class="card"><h3>Cashiers</h3><p><%= employees.filter(e => e.role==='Cashier').length %></p></div>
    </div>

    <h3>Employee List</h3>
    <table>
      <tr><th>ID</th><th>Name</th><th>Email</th><th>Role</th><th>Salary</th><th>Action</th></tr>
      <% employees.forEach(emp => { %>
      <tr>
        <td><%= emp.id %></td>
        <td><%= emp.name %></td>
        <td><%= emp.email %></td>
        <td><%= emp.role %></td>
        <td>₹<%= emp.salary %></td>
        <td>
          <button class="btn-edit"
                  data-id="<%= emp.id %>"
                  data-name="<%= emp.name %>"
                  data-email="<%= emp.email %>"
                  data-role="<%= emp.role %>"
                  data-salary="<%= emp.salary %>">Edit</button>
          <form action="/delete-employee/<%= emp.id %>" method="POST" style="display:inline;">
            <button type="submit" class="btn-delete">Delete</button>
          </form>
        </td>
      </tr>
      <% }) %>
    </table>
  </div>

  <!-- Add Modal -->
  <div id="myModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h3>Add Employee</h3>
      <form action="/add-employee" method="POST">
        <input type="text" name="name" placeholder="Employee Name" required>
        <input type="email" name="email" placeholder="Employee Email" required>
        <select name="role" required>
          <option value="" disabled selected>Select Role</option>
          <option value="Manager">Manager</option>
          <option value="Accountant">Accountant</option>
          <option value="Cashier">Cashier</option>
          <option value="Clerk">Clerk</option>
          <option value="IT Support">IT Support</option>
        </select>
        <input type="number" name="salary" placeholder="Employee Salary" required>
        <button type="submit" class="btn-add">Add Employee</button>
      </form>
    </div>
  </div>

  <!-- Edit Modal -->
  <div id="editModal" class="modal">
    <div class="modal-content">
      <span class="close" id="closeEdit">&times;</span>
      <h3>Edit Employee</h3>
      <form id="editForm" method="POST">
        <input type="text" name="name" id="editName" placeholder="Employee Name" required>
        <input type="email" name="email" id="editEmail" placeholder="Employee Email" required>
        <select name="role" id="editRole" required>
          <option value="" disabled>Select Role</option>
          <option value="Manager">Manager</option>
          <option value="Accountant">Accountant</option>
          <option value="Cashier">Cashier</option>
          <option value="Clerk">Clerk</option>
          <option value="IT Support">IT Support</option>
        </select>
        <input type="number" name="salary" id="editSalary" placeholder="Employee Salary" required>
        <button type="submit" class="btn-add">Update Employee</button>
      </form>
    </div>
  </div>

  <script>
    const modal = document.getElementById("myModal");
    const openModalBtn = document.getElementById("openModal");
    const closeModalBtn = document.querySelector(".close");
    openModalBtn.onclick = () => modal.style.display = "block";
    closeModalBtn.onclick = () => modal.style.display = "none";
    window.onclick = (e) => { if(e.target == modal) modal.style.display = "none"; }

    const editModal = document.getElementById("editModal");
    const closeEditBtn = document.getElementById("closeEdit");
    const editForm = document.getElementById("editForm");
    document.querySelectorAll(".btn-edit").forEach(btn => {
      btn.onclick = () => {
        const id = btn.dataset.id;
        document.getElementById("editName").value = btn.dataset.name;
        document.getElementById("editEmail").value = btn.dataset.email;
        document.getElementById("editRole").value = btn.dataset.role;
        document.getElementById("editSalary").value = btn.dataset.salary;
        editForm.action = `/edit-employee/${id}`;
        editModal.style.display = "block";
      };
    });
    closeEditBtn.onclick = () => editModal.style.display = "none";
    window.onclick = e => { if(e.target == editModal) editModal.style.display = "none"; }
  </script>
</body>
</html>
